/* ************************************************************************** */
/*                                                                            */
/*                                                        :::      ::::::::   */
/*   push_swap.c                                        :+:      :+:    :+:   */
/*                                                    +:+ +:+         +:+     */
/*   By: ylouvel <ylouvel@student.42lehavre.fr>     +#+  +:+       +#+        */
/*                                                +#+#+#+#+#+   +#+           */
/*   Created: 2025/10/27 00:41:38 by yanis             #+#    #+#             */
/*   Updated: 2025/10/29 16:33:38 by ylouvel          ###   ########.fr       */
/*                                                                            */
/* ************************************************************************** */

#include "../include/push_swap.h"

void	print_list(t_stack *stack, int i)
{
	if (i == 1)
		printf("Stack A :\n");
	else
		printf("Stack B :\n");
	while (stack)
	{
		printf("[%d]%d\n", stack->index, stack->value);
		stack = stack->next;
	}
	printf("\n");
}

// void	push_swap(t_stack **stack_a, t_stack **stack_b)
// {
// 	t_stack	*head_a;
// 	t_stack	*head_b;
// 	head_a = *stack_a;
// 	head_b = *stack_b;
// 	// radix sort
// 	radix_sort(&head_a, &head_b);
// 	*stack_a = head_a;
// 	*stack_b = head_b;
// }

int	is_sorted(t_stack *stackA)
{
	t_stack	*tmp;
	int		i;
	int		sorted;

	tmp = stackA;
	i = INT_MIN;
	sorted = 0;
	while (tmp)
	{
		if (i > tmp->value)
			sorted = 1;
		;
		i = tmp->value;
		tmp = tmp->next;
	}
	if (sorted == 1)
		return (0);
	return (1);
}

void	push_swap(t_stack **stackA, t_stack **stackB)
{
	int	max_bits;
	int	size;
	int	i;
	int	j;

	max_bits = 0;
	size = strlenStack(*stackA);
	while ((size - 1) >> max_bits)
		max_bits++;
	i = 0;
	while (i < max_bits && !is_sorted(*stackA))
	{
		j = 0;
		while (j < size)
		{
			if (((*stackA)->index >> i) & 1)
				ft_rotate(stackA, 'a');
			else
				ft_push(stackA, stackB, 'b');
			j++;
		}
		while (*stackB)
			ft_push(stackB, stackA, 'a');
		i++;
	}
}

void	print_bin(void)
{
	int	i;
	int	bit;
	int	size;

	i = 0;
	size = 0;
	bit = 10;
	while (10 >> size)
		size++;
	printf("size : %d\n", size);
	i = size - 1;
	while (i >= 0)
	{
		if (((bit >> i) & 1))
			printf("1");
		else
			printf("0");
		i--;
	}
}

int	main(int argc, char *argv[])
{
	t_stack	*stackA;
	t_stack	*stackB;
	t_data	*data;

	if (argc >= 2)
	{
		data = get_data();
		stackB = NULL;
		stackA = init_stack(argc, argv); //* Parsing fini
		is_sorted(stackA);
		push_swap(&stackA, &stackB);
		print_list(stackA, 1);
		print_list(stackB, 0);
		printf("data count: %d\n", data->count);
		print_bin();
	}
	return (0);
}

// ./push_swap 24 57 98 66 46 33 23 42 37 75 27 74 1 73 96 80 60 32 81 48 78 17 22 52 92 19 36 65 12 47 72 94 54 9 14 6 53 90 59 15 88 63 25 35 26 11 83 2 28 51 18 43 82 8 41 68 67 50 30 44 79 58 21 85 100 39 49 70 45 95 29 99 13 84 56 87 97 62 71 3 61 86 76 7 40 20 77 55 34 5 89 93 91 69 64 4 10 16 31 38
// ./push_swap 52 67 16 39 11 54 22 63 53 56 36 84 24 13 4 3 44 94 61 2 62 60 17 43 93 81 6 100 74 83 99 69 8 37 73 33 82 5 30 96 55 21 92 14 19 27 76 57 65 18 32 25 86 42 88 70 49 51 47 35 71 50 78 40 38 59 28 95 26 64 12 31 1 7 68 77 10 58 29 98 79 20 87 23 15 48 97 41 9 46 34 91 89 45 85 66 75 80 72 90
// ./push_swap 43 49 80 59 27 8 17 21 82 68 6 7 52 1 66 98 35 69 79 57 58 44 60 25 91 61 33 38 84 76 31 45 42 53 13 54 86 46 47 4 41 78 93 73 81 36 87 67 100 32 94 92 20 63 55 95 28 18 83 14 29 51 62 15 90 30 65 64 19 85 74 72 24 23 70 97 75 50 12 16 71 48 77 22 96 2 10 88 37 11 9 89 34 26 40 39 56 3 99 5

// ./push_swap 397 32 463 334 112 392 135 165 303 30 434 64 351 354 367 113 267 442 315 172 324 115 12 407 302 108 225 220 330 85 147 451 476 486 306 477 378 23 282 443 207 428 310 393 416 298 41 201 175 308 137 403 164 69 423 216 390 412 219 169 200 497 495 339 126 499 448 376 353 19 127 285 198 456 110 189 417 102 31 74 146 381 409 250 375 359 335 452 346 185 138 372 67 316 161 239 243 71 186 141 39 379 405 134 281 142 99 383 424 100 487 140 311 345 124 427 148 232 474 6 125 4 59 297 28 20 244 342 338 382 333 181 184 438 114 214 197 48 242 119 132 492 387 326 245 396 237 211 467 363 410 357 62 209 14 439 47 419 466 317 399 352 418 314 101 226 483 251 464 65 261 321 374 153 205 247 277 294 53 158 149 55 484 457 292 411 38 87 57 8 391 444 377 24 75 93 373 224 156 117 109 70 76 430 426 394 332 380 1 494 210 111 262 265 170 162 395 152 406 347 120 340 369 468 433 398 362 60 27 233 485 163 274 121 264 72 81 240 299 425 249 300 449 179 68 3 139 462 286 95 160 21 212 435 86 89 106 155 104 421 408 178 15 131 52 279
// 386 348 472 432 328 337 154 266 364 91 445 168 320 361 77 473 493 193 183 478 208 459 301 475 366 105 215 174 118 290 371 280 254 273 9 213 54 400 159 312 187 385 259 313 437 88 136 107 284 355 66 489 255 83 500 61 388 341 479 272 256 236 18 202 96 257 204 203 370 7 26 122 17 231 128 58 29 46 130 481 199 323 269 43 447 404 436 318 293 150 360 79 177 22 356 453 490 349 217 429 192 123 90 350 319 182 344 454 450 33 221 37 307 368 336 194 97 460 469 195 252 260 133 458 206 238 80 276 44 289 103 446 343 465 471 480 36 304 305 10 322 331 166 191 488 78 461 440 491 167 176 235 151 327 234 13 73 271 241 82 296 49 230 263 145 98 246 389 287 180 143 2 129 228 196 325 415 365 278 288 42 45 35 309 420 171 253 34 431 190 51 441 295 498 188 283 414 223 25 258 157 144 218 227 402 275 16 358 5 496 56 40 116 84 455 173 470 268 401 63 422 291 248 11 482 50 94 413 92 329 270 384 222 229
// ./push_swap 103 451 414 203 140 238 114 101 54 85 389 339 447 318 192 311 386 325 284 321 341 124 64 322 213 383 433 347 202 375 237 420 496 63 312 56 37 12 473 415 332 49 313 80 167 280 207 109 205 385 197 36 314 353 73 162 458 78 406 464 117 270 92 17 20 222 45 33 436 315 244 183 224 190 100 57 176 379 147 456 396 336 166 95 450 177 370 171 481 292 48 182 448 355 399 299 449 127 411 132 282 307 305 438 77 492 186 97 271 141 422 119 437 130 297 296 211 163 358 392 28 334 219 371 220 172 179 58 122 194 204 149 457 2 345 265 373 201 300 474 181 50 252 272 68 289 81 210 157 490 191 360 497 1 354 129 41 151 258 66 343 404 235 107 39 398 470 160 223 126 408 500 454 62 426 139 445 174 164 419 467 423 268 51 105 488 23 335 390 165 206 365 221 407 110 67 344 468 439 148 424 19 189 263 82 276 257 368 397 413 494 487 178 52 65 352 44 357 10 199 6 231 90 144 246 446 453 169 225 274 401 418 266 125 131 285 146 425 254 241 286 273 35 53 376 463 242 283 478 161 317 324 111 287 359 346 142 14 134 234 331 294 367 333 403
// 320 195 323 275 98 236 26 209 279 349 138 278 251 83 356 417 16 94 377 484 40 380 295 9 5 429 281 170 153 232 475 319 361 435 154 303 262 69 465 466 88 38 469 104 136 143 452 214 99 193 293 499 248 86 409 229 200 260 128 116 337 89 72 442 70 239 106 430 76 350 135 108 4 267 485 342 412 330 298 382 455 156 388 472 310 42 304 180 489 215 363 22 31 277 115 150 253 11 269 395 230 444 59 185 43 255 55 46 34 309 476 120 378 187 123 7 24 243 498 218 75 21 421 184 441 394 240 74 91 393 301 405 288 29 25 402 84 477 400 159 30 61 96 226 391 291 102 188 228 482 483 247 264 410 256 121 351 198 328 249 381 290 175 233 15 245 71 3 133 208 158 387 32 338 60 93 479 491 217 168 459 428 416 306 259 327 261 212 486 145 8 137 196 118 384 87 493 440 369 302 155 47 326 152 362 480 364 113 79 112 329 216 443 427 250 431 374 227 348 471 495 13 366 462 434 173 308 316 461 372 18 432 460 340 27
// ./push_swap 405 420 440 76 119 240 345 39 69 375 133 17 42 489 444 437 195 479 193 500 128 297 339 61 262 97 246 199 70 450 81 327 329 495 88 216 378 64 16 491 257 175 136 74 483 361 332 424 426 469 373 477 107 436 198 352 441 102 10 223 148 432 372 267 172 340 416 476 180 284 179 484 468 8 141 390 247 307 237 190 289 7 226 161 309 277 350 261 455 105 201 55 45 293 343 254 35 244 488 181 473 187 159 2 417 50 411 243 328 132 13 474 143 382 371 290 210 418 79 238 220 203 406 319 347 321 53 412 4 24 430 467 51 32 130 52 344 109 273 358 149 308 21 337 376 301 146 494 47 11 391 22 270 397 318 338 207 410 155 499 29 304 264 99 282 446 227 317 369 20 331 229 34 497 82 242 278 153 314 151 157 73 348 137 281 291 12 370 458 101 394 217 120 322 100 448 46 144 129 211 271 315 57 15 381 91 106 123 103 461 413 422 294 403 126 404 393 360 30 156 392 485 185 326 3 288 253 464 433 266 471 235 279 28 333 183 396 241 435 249 478 154 306 164 33 414 300 493 40 399 66 341 487 208 177 481 492 354 438 121 96 174 192 204 36 83 75
// 388 364 71 72 108 1 320 269 48 168 160 409 150 176 113 316 221 268 443 368 118 303 112 230 77 65 62 163 5 255 356 287 209 54 178 353 25 258 452 23 218 134 214 387 171 265 186 377 215 222 462 359 166 27 117 421 342 427 26 346 285 325 19 299 142 263 189 43 114 383 334 386 401 58 78 202 280 194 431 439 260 275 313 428 400 158 248 170 490 115 147 445 124 363 212 434 472 44 233 365 219 292 310 86 423 298 486 259 496 6 37 38 59 135 407 449 384 152 110 324 234 457 196 276 425 456 138 80 9 305 459 330 302 480 250 56 465 466 85 200 239 398 206 366 379 87 60 173 470 139 131 191 89 125 447 224 236 286 336 475 205 274 367 68 127 463 184 380 419 252 451 122 169 67 116 482 395 251 295 49 167 312 104 256 408 111 63 245 165 197 93 232 460 335 94 228 90 213 14 41 272 357 453 84 349 311 31 140 18 162 415 296 95 145 454 362 323 402 92 351 429 283 389 374 385 355 188 182 442 98 498 231 225